---
page_type: sample
products:
- office-outlook
- ms-graph
languages:
- csharp
- windows-uwp
extensions:
  contentType: samples
  technologies:
  - Microsoft Graph 
  services:
  - Outlook
  createdDate: 9/28/2016 4:33:07 PM
---
# Пример Microsoft Graph MeetingBot для UWP

## Содержание

* [Введение](#introduction)
* [Предварительные требования](#prerequisites)
* [Регистрация и настройка приложения](#register)
* [Сборка и отладка](#build)
* [Запуск примера](#runningsample)
* [Вопросы и комментарии](#questions)
* [Дополнительные ресурсы](#additional-resources)

<a name="introduction"></a>
## Введение

В этом примере показано, как интегрировать возможности Microsoft Graph в приложение UWP, в котором используются голосовые команды Кортаны. После установки и входа приложение можно активировать, отправив Кортане голосовой запрос на показ следующей встречи в календаре и (или) отправку участникам следующей встречи сообщения о том, что вы опаздываете.

Для работы с данными, которые возвращает Microsoft Graph, используется [клиентская библиотека Microsoft Graph .NET](https://github.com/microsoftgraph/msgraph-sdk-dotnet). В этом примере для проверки подлинности используется конечная точка версии 2.0, которая позволяет пользователям выполнять вход с использованием личных, рабочих или учебных учетных записей Майкрософт.

<a name="prerequisites"></a>
## Предварительные требования

Для этого примера требуются следующие компоненты:  

* [Visual Studio](https://www.visualstudio.com/en-us/downloads) 
* Windows 10 ([с включенным режимом разработки](https://msdn.microsoft.com/library/windows/apps/xaml/dn706236.aspx)).
* Учетная запись [Microsoft](www.outlook.com) или [Office 365 для бизнеса](https://msdn.microsoft.com/en-us/office/office365/howto/setup-development-environment#bk_Office365Account).

<a name="register"></a>
## Регистрация приложения

1. Перейдите на страницу [портала Azure](https://aka.ms/AppRegistrations), чтобы зарегистрировать ваше приложение. Войдите с помощью **личной учетной записи** (т. е. учетной записи Майкрософт) или **рабочей или учебной учетной записи**.

2. Выберите **Новая регистрация**. На странице **Регистрация приложения** задайте необходимые значения следующим образом:

    * Установите **Имя** как `MeetingBot-Пример`.
    * Установите **Поддерживаемые типы учетных записей** в **Учетные записи в любом каталоге организации и личные учетные записи Майкрософт**.
    * Оставьте поле **URI перенаправления** пустым.
    * Нажмите **Зарегистрировать**.

3. На странице **MeetingBot-Пример** скопируйте значение **Идентификатор приложения (клиента)**. Оно понадобится вам позднее.

4. Выберите ссылку **Добавить URI перенаправления**. На странице **URI перенаправления** найдите раздел **Предлагаемые URI перенаправления для общедоступных клиентов (мобильные, настольные)**. Выберите URI, который начинается с `msal` **и** URI **urn:ietf:wg:oauth:2.0:oob**.

5. В верхней части страницы щелкните**Сохранить**.

<a name="build"></a>
## Сборка и отладка

**Примечание.** Если во время установки пакетов при выполнении шага 2 возникают ошибки, убедитесь, что локальный путь к решению не слишком длинный. Чтобы устранить эту проблему, переместите решение ближе к корню диска.

1. После загрузки решения в Visual Studio настройте приложение на использование идентификатора приложения, зарегистрированного путем добавления соответствующих значений для этих ключей в узел Application.Resources в файле App.xaml. Значение идентификатора примера приложения
![Microsoft Graph MeetingBot](/readme-images/appId_and_redirectURI.png "в файле App.xaml")

2. Нажмите клавишу F5 для сборки и отладки. Запустите решение и войдите в систему с помощью личной, рабочей или учебной учетной записи.

<a name="runningsample"></a>
## Запуск примера

При первом запуске примера появится предложение войти с помощью учетной записи [Майкрософт](www.outlook.com) или [Office 365 для бизнеса](https://msdn.microsoft.com/en-us/office/office365/howto/setup-development-environment#bk_Office365Account). После проверки подлинности и предоставления согласия на необходимые разрешения осуществлять вход заново нужно будет только в случае, если понадобится запустить пример с помощью другой учетной записи. 

Чтобы выйти и затем войти с помощью другой учетной записи, нажмите в приложении кнопку **отключить**вверху справа и затем нажмите кнопку**подключить** слева.

После первой установки и запуска приложения его можно активировать в любой момент, отправив Кортане указанные далее голосовые команды.

1. "MeetingBot, покажи мою следующую встречу".
2. "MeetingBot, передай участникам следующей встречи, что я опаздываю".

Если [включена функция "Привет, Кортана!"](https://www.cnet.com/how-to/how-to-enable-hey-cortana-on-windows-10/), приложение можно активировать в любой момент, отправив на ваше устройство указанные далее голосовые команды.

1. "Привет, Кортана! Попроси MeetingBot показать мою следующую встречу".
2. "Привет, Кортана! Попроси MeetingBot передать участникам следующей встречи, что я опаздываю".

В обоих случаях в приложении запустятся и отобразятся название и время вашей следующей встречи. Если попросить MeetingBot передать участникам следующей встречи, что вы опаздываете, приложение либо подтвердит, что такое сообщение об опоздании им отправлено, либо сообщит, что в почтовом ящике вашей учетной записи приглашение на эту встречу отсутствует.

![Пример Microsoft Graph MeetingBot](/readme-images/MeetingBotLateMessage.png "MeetingBot после отправки сообщения об опоздании")

<a name="contributing"></a>
## Участие

Если вы хотите добавить код в этот пример, просмотрите статью [CONTRIBUTING.MD](/CONTRIBUTING.md).

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

<a name="questions"></a>
## Вопросы и комментарии

Мы будем рады узнать ваше мнение о проекте Microsoft Graph MeetingBot для UWP. Вы можете отправлять нам вопросы и предложения в разделе [Проблемы](https://github.com/microsoftgraph/uwp-csharp-meetingbot-sample/issues) этого репозитория.

Ваши отзывы важны для нас. Для связи с нами используйте сайт [Stack Overflow](http://stackoverflow.com/questions/tagged/microsoftgraph). Помечайте свои вопросы тегом [MicrosoftGraph].

<a name="additional-resources"></a>
## Дополнительные ресурсы

* [Другие примеры Microsoft Graph UWP](https://github.com/microsoftgraph?utf8=%E2%9C%93&query=uwp)
* [Общие сведения о Microsoft Graph](http://graph.microsoft.io)
* [Примеры кода решений для Office](http://dev.office.com/code-samples)
* [Центр разработки для Office](http://dev.office.com/)

## Авторские права
(c) Корпорация Майкрософт (Microsoft Corporation), 2016. Все права защищены.
